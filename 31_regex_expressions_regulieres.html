<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{background-color: rgb(18, 195, 56);}
        .container{
            width: 70%; 
            margin: auto; 
            padding: 1.9rem;
            background-color: white;
            border-radius: 1rem;
        }
        form > div
        {
            margin-bottom: 1rem;
        }
        input:not([type="checkbox"], [type="radio"])
        {      
            width: 100%;
            height: 2rem;
            margin: .1rem 0 .1rem;            
            border-radius: .9rem;
            border: 1px solid rgb(18, 195, 56);
        }
        [type="submit"]
        {
            height: 3rem;
            width: 100%;
            margin-top: 1rem;
            font-size: 1.2rem;
            font-weight: 900;
            border-radius: 2rem;
            border: none;     
            color: white;
            background-color: rgb(18, 195, 56);       
        }
        [type="submit"]:hover
        {            
            cursor: pointer;
            color: rgb(18, 195, 56);
            background-color: rgb(203, 211, 205); 
        }
        [class="hidden"]
        {
            display: none;            
        }
        input+small
        {
            color: red;
        }
        .animate-txt
        {
            font-size: 1.2rem;
        }
    </style>
    <title>RegEx - Expressions regulieres</title>
</head>
<body>
    <div class="container">
        <form name="signInForm" action="" method="POST">
            <div id="box-name">
                <label for="name">nom</label>
                <input type="text" id="name" name="name" />
                <!-- <small id="message-name" class="hidden"></small> -->
            </div>
            <div id="box-firstname">
                <label for="firstname">prenom</label>
                <input type="text" id="firstname" name="firstname" />
            </div>
            <div id="box-aka">
                <label for="aka">Pseudonyme</label>
                <input type="text" id="aka" name="aka" />
            </div>
            <div id="box-email">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" />
            </div>
            <div>
                <label for="commentary">Commentary</label>
                <input type="text" id="commentary" name="commentary" />
            </div>
            <button type="submit">Enregistrer</button>
        </form>
    </div>
    
    <script>
        let signInForm = document.querySelector(`[name="signInForm"]`);
        let checkName = new RegExp(/^[a-zA-Z]+(?:[\-\s'][a-zA-Z]+)*$/gi);
        let checkFirstname = new RegExp(/^[a-zA-Z]+(?:[\-\s'][a-zA-Z]+)*$/gi);
        let checkEmail = new RegExp(/^([a-z0-9]+(?:[._-][a-z0-9]+)*)@([a-z0-9]+(?:[.-][a-z0-9]+)*\.[a-z]{2,})$/gi);
        let checkCommentary = new RegExp('/(^HITLER)/')
        let mySearch = new RegExp(`^paragraphe[0-9]+$`); // motif ou l'occurence
        //let name = document.getElementById('name')
        const messages = [];
        // let mot1 = "paragraphe10";
        // let mot2 = "1section_paragraphe1";        

       // console.log(mot2.includes(`paragraphe`));

        // RegEx => Regular Expressions => expressions régulières
       
        
        
        // Good regEx checking double dots :
        // ^([a-z0-9]+(?:[._-][a-z0-9]+)*)@([a-z0-9]+(?:[.-][a-z0-9]+)*\.[a-z]{2,})$
        
        //let checkEmail = new RegExp('^[a-z]+[-_\.a-z]*@[a-z]+[-_\.a-z]*\.[a-z]{2,}$');
      
     
          
        const showMessage = (field, message) =>{
            let fieldBox = document.getElementById(field);
            let small = document.createElement('small');            
            if(!document.getElementById(`small-${field}`)) // we check if a message has already been sent
            {
               small.setAttribute('id', `small-${field}`)
               small.innerText = message;
               fieldBox.appendChild(small);  
            }   
            else
            {
                small = document.getElementById(`small-${field}`);
                small.innerText = message;
                
            }             
        }




        signInForm.addEventListener('submit', (e) =>{     
            console.log(checkCommentary.test(signInForm.commentary.value));         
            if(checkName.test(signInForm.name.value.trim()))
            {                
                alert(`Le nom ${signInForm.name.value} est valide`);
                showMessage(`box-name`,`OK`);  
            }
            else
            {                   
                //messages.push(`Le nom est invalide`);                   
                showMessage(`box-name`,`Le nom est invalide`);                      
                e.preventDefault();
            }    

            if(checkFirstname.test(signInForm.firstname.value.trim()))
            {
                alert(`Le prénom ${signInForm.firstname.value} est valide`);
                showMessage(`box-firstname`,`ok`);  
            }
            else
            {                  
                showMessage(`box-firstname`,`Le prénom est invalide`);                      
                e.preventDefault();
            }  
            
            if(checkEmail.test(signInForm.email.value))
            { 
                alert(`L'email ${signInForm.email.value} est valide`);
                showMessage(`box-email`, `OK`);
                alert(`L'email ${signInForm.email.value} est BIEN valide`);             
                //messages.push(`L'email ${signInForm.email.value} est valide`)
                e.preventDefault(); 
            }
            else
            {                 
                alert(`L'email ${signInForm.email.value} est invalide`);
                showMessage(`box-email`,`L'email est invalide`);  
                e.preventDefault();
            }
        })

    </script>
</body>
</html>